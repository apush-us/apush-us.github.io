<head>
	<meta charset="UTF-8"> 
	<title>Grumio - Latin-English Dictionary</title>
	<link rel="stylesheet" href="style.css">
	<link href="https://fonts.googleapis.com/css?family=Quando" rel="stylesheet">

</head>

<body>

<div id="main" class="inner-element">
  <h1>Grumio</h1>
	<h3>A Latin-English Dictionary</h3>
	<input type="text" name="q" id="searchbox" class="searchinput" placeholder="Type English or Latin. Don't worry about long marks."><br>
</div>

<div id="word" class="inner-element">
<p><b><span id="prins"></span></b></p>
<p><span id="meaning"></span></p>
<hr>

<br>
<table>
  <tr>
    <th>Part of Speech</th>
    <td><span id="pos"></span></td>
  </tr>
  <tr>
    <th>In Vocab List<span id="listplural"></span></th>
    <td><span id="stages"></span></td>
  </tr>
</table>
<br>
<p><a href="index.html">Back to search</a></p>
</div>


</body>

<script src="data.js"></script>
<script src="auto-complete.js"></script>

<script charset="utf-8">

var main = document.getElementById("main");
var word = document.getElementById("word");

document.getElementById('searchbox').value = "";

function startString (little,big) {
	if (typeof big == "object") {
	  for (yoink in big) {
		  if (little == big[yoink].substring(0,little.length)) {
			  return true;
			}
		}
		return false;
	} else if (little == big.substring(0,little.length)) {
		return true;
	} else {
		return false;
	}
}	

function getID (peepee) {
	for (poopoo in wdict) {
		if (wdict[poopoo][1] == peepee) return wdict[poopoo][0];
	}
}	

new autoComplete({
    selector: 'input[name="q"]',
    minChars: 1,
    source: function(term, suggest){
        term = term.toLowerCase();
				term = term.normalize('NFD').replace(/[\u0300-\u036f]/g, "");
        var choices = choicebois;
        var matches = [];
        for (i=0; i<choices.length; i++) {
						if (startString(term,choices[i][0].normalize('NFD').replace(/[\u0300-\u036f]/g, ""))) matches.push(choices[i]);
				}
				for (i=0; i<choices.length; i++) {
				    pps = choices[i][0].normalize('NFD').replace(/[\u0300-\u036f]/g, "").split(", ")
						if (startString(term,pps.slice(1,pps.length)) && !matches.includes(choices[i])) matches.push(choices[i]);
				}
				for (i=0; i<choices.length; i++) {
				    pps = choices[i][1].normalize('NFD').replace(/[\u0300-\u036f]/g, "").split(", ")
						if (startString(term,pps) && !matches.includes(choices[i])) matches.push(choices[i]);
				}
        suggest(matches);
    },
		renderItem: function (item, search) {
			return '<div class="autocomplete-suggestion" data-val="' + item[0] + '"><b>' + item[0] + '</b>  ' + item[1] + '</div>';
		},
		onSelect: function(e, term, item){
			window.location.href = "?" + getID(term.replace(/, /g,","));
    }
});

var urlParams = new URLSearchParams(window.location.search);
var query = urlParams.toString().slice(0, -1)
var p1 = []
var p2 = []
var p3 = []



query = query.normalize('NFD').replace(/[\u0300-\u036f]/g, "");



if (query == "") {
	main.style.display = "block";
} else if (wordlist.indexOf(query) == -1){
	window.location.href = "?"
} else {

	winfo = wdict[wordlist.indexOf(query)]
	
	var outputs = [];
	outputs.push(winfo[1].replace(/,/g,", "));
	outputs.push(winfo[2].replace(/,/g,", "));
	outputs.push(["Adjective","Conjunction","Adverb","Interjection","Noun","Preposition","Interrogative","Verb","Common Latin phrase"][["a","c","y","i","n","p","q","v","s"].indexOf(winfo[3])])
	outputs.push(winfo[4].replace(/,/g,", "));
	if (outputs[3].split(",").length == 1) {
	  outputs.push("");
	} else {
	  outputs.push("s");
	}
	
	document.getElementById('prins').innerHTML = outputs[0];
	document.getElementById('meaning').innerHTML = outputs[1];
	document.getElementById('pos').innerHTML = outputs[2];
	document.getElementById('stages').innerHTML = outputs[3];
	document.getElementById('listplural').innerHTML = outputs[4];
	
	
	word.style.display = "block";
}



</script>